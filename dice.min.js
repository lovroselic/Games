
var dieElement="<div class='dice'><canvas></canvas></div>";var answerElement="<div id='enter'>Enter the sum of all the dots: <input id='inp' type='text'/></div>";var hiscore=[200,100,50,20,10];var hiscore_name=["C00lSch00l","C00lSch00l","C00lSch00l","C00lSch00l","C00lSch00l"];var Round,maxRound,solution,score,timeA,timeB,myBlink,myWink;var sizeWink=5;var direction=1;var winkCC=100;var winkDir=1;$(document).ready(function(){loadHS();hiScore();$("form").bind("keypress",function(a){if(a.keyCode==13){return false}});$("#randomize").click(function(){if(this.checked){$("#dice").prop("disabled",true)}else{$("#dice").prop("disabled",false)}});$("#dice").focusout(function(){var a=$(this).val();$(this).val(validateInput(a,2,6,3))});$("#rounds").focusout(function(){var a=$(this).val();$(this).val(validateInput(a,5,25,10))});$("#start").click(function(){disableSetup();maxRound=$("#rounds").val();$("#roll").prop("disabled",false);Round=1;$("#roundCounter").html(Round);$("#score_container").html("Score: <span id='score'></span>");score=0;$("#score").html(score);$("#enter").hide();myBlink=setInterval(blink,2000)});$("#roll").click(function(){$("#roll").prop("disabled",true);clearInterval(myBlink);myWink=setInterval(wink,300);cycle()});$("#message").on("keypress","#inp",function(a){if(a.which==13){a.preventDefault();checkResult()}})});function checkResult(){myBlink=setInterval(blink,2000);clearInterval(myWink);var e=new Date();timeB=e.getTime();var c=Math.floor((timeB-timeA)/1000);var b=$("#inp").val();b=b.trim().toUpperCase();var a=solution;solution=numToWord(solution).toUpperCase();if(solution===b){$("#inp").replaceWith("<span class='right'>"+solution+"</span>");score+=10+a+Math.floor(score/c);$("#score").html(score)}else{$("#inp").replaceWith("<span class='wrong'>"+b+"</span> <span class='shouldbe'>"+solution+"</span>");score-=5;if(score<0){score=0}$("#score").html(score)}Round++;if(Round>maxRound){endGame()}else{$("#roll").prop("disabled",false)}}function cycle(){var b;$("#roundCounter").html(Round);$("#message")[0].scrollIntoView(true);if($("#randomize").prop("checked")===true){b=rnd(2,6)}else{b=parseInt($("#dice").val(),10)}solution=drawDice(b);$("#answers").html(answerElement);$("#inp").focus();var a=new Date();timeA=a.getTime()}function disableSetup(){$("#score_container").show();$("#message").show();$("#dice").prop("disabled",true);$("#randomize").prop("disabled",true);$("#rounds").prop("disabled",true);$("#start").prop("disabled",true)}function enableSetup(){$("#dice").prop("disabled",false);$("#randomize").prop("disabled",false);$("#rounds").prop("disabled",false);$("#start").prop("disabled",false)}function endGame(){clearInterval(myBlink);$("#score_container").html("<span class='shouldbe'>Congratulations. You managed to get "+score+" points.</span>");checkScore(score);hiScore();enableSetup()}function drawDice(c){$("#board").html("");var d=0;for(var a=0;a<c;a++){var b=rnd(1,6);addDie(a);drawFace(b,"d"+a);d+=b}return d}function addDie(a){$("#board").append(dieElement);$("#board div").last().attr("id","X"+a);$("#X"+a+" canvas").attr("id","d"+a);return}function drawFace(d,f){d--;var e=$("#"+f)[0];var b=e.getContext("2d");img=new Image();img.src="http://www.c00lsch00l.eu/Sprite/dice6.sprite.png";var a=120;img.onload=function(){b.translate(a,0);b.rotate(Math.PI/2);b.clearRect(0,0,a,a);b.drawImage(img,a*d,0,a,a,0,0,a,a)};return}function rnd(b,a){return Math.floor(Math.random()*(++a-b)+b)}function numToWord(f){var e=f%10;var a=Math.floor(f/10);if(f>=20){var d=c(e);var g=b(a);var i;if(d===-1){i=g}else{i=g+"-"+d}return i}else{if(f<=10){if(a){return b(a)}else{return c(e)}}else{if(f===11){return"eleven"}else{if(f===12){return"twelve"}else{if(f>12&&f<20){return h(f)}}}}}function c(j){switch(j){case 1:return"one";case 2:return"two";case 3:return"three";case 4:return"four";case 5:return"five";case 6:return"six";case 7:return"seven";case 8:return"eight";case 9:return"nine";default:return -1}}function b(j){switch(j){case 1:return"ten";case 2:return"twenty";case 3:return"thirty";case 4:return"forty";case 5:return"fifty";case 6:return"sixty";case 7:return"seventy";case 8:return"eighty";case 9:return"ninety";default:return -1}}function h(j){switch(j){case 13:return"thirteen";case 14:return"fourteen";case 15:return"fifteen";case 16:return"sixteen";case 17:return"seventeen";case 18:return"eighteen";case 19:return"nineteen";default:return -1}}}function hiScore(){var b="";for(var a=1;a<=5;a++){b+=a+". "+hiscore_name[a-1]+" "+pad(hiscore[a-1])+"<br/>"}$("#hiscore").html(b);saveHS();return}function stringFill(a,c){var b="";for(;;){if(c&1){b+=a}c>>=1;if(c){a+=a}else{break}}return b}function pad(a){var b="\u0020\u0020\u0020\u0020\u0020"+a;return b.substring(b.length-5)}function saveHS(){localStorage.setItem("DA","OK");for(var a=0;a<5;a++){localStorage.setItem("DA_HName"+a,hiscore_name[a]);localStorage.setItem("DA_HScore"+a,hiscore[a])}}function loadHS(){if(localStorage.DA==="OK"){for(var a=0;a<5;a++){hiscore_name[a]=localStorage.getItem("DA_HName"+a);hiscore[a]=localStorage.getItem("DA_HScore"+a)}}}function validateInput(d,b,a,c){if(isNaN(d)){return c}if(d<b){return b}if(d>a){return a}return d}function checkScore(c){var e=4;while(c>hiscore[e]&&e>=0){e--}e++;if(e===5){return}else{var a=prompt("You reached top 5 score. Enter your name (max 10 characters): ");if(a.length>10){a=a.substring(0,10)}else{if(a.length<10){var b=10-a.length;var d=stringFill("&nbsp",b);a+=d}}hiscore.splice(e,0,c);hiscore_name.splice(e,0,a);hiscore.splice(5,1);hiscore_name.splice(5,1)}$("#setup")[0].scrollIntoView();return}function blink(){$("#roll").animate({width:"125px",height:"94px"},300);$("#roll").animate({width:"100px",height:"75px"},300);return}function wink(){sizeWink+=direction;if(sizeWink>=13||sizeWink<=3){direction=direction*-1}winkCC+=16*winkDir;if(winkCC>=244||winkCC<=63){winkDir=winkDir*-1}var b=RGBtoHex(0,0,winkCC);var a="2px 0px 20px "+sizeWink+"px "+b;$("#inp").css("box-shadow",a);return}function RGBtoHex(d,c,a){return"#"+e(d)+e(c)+e(a);function e(f){var b=f.toString(16);return b.length==1?"0"+b:b}};